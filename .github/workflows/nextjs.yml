- name: Setup Node
  uses: actions/setup-node@v4
  with:
    node-version: "20"
    cache: npm

# ðŸ”Ž Debug & forcer le registre public npm
- name: Debug npm & force public registry
  run: |
    echo "registry=https://registry.npmjs.org/" > .npmrc
    npm config list -l | sed -n '1,120p'
    echo "NPM registry: $(npm config get registry)"
    npm ping

# ðŸ’¡ Installe sans audit/fund pour Ã©viter du bruit rÃ©seau
- name: Install dependencies
  run: npm ci --no-audit --no-fund

- name: Setup Pages
  uses: actions/configure-pages@v5
  with:
    static_site_generator: next

- name: Build with Next.js (export)
  run: |
    npx --no-install next build
    npx --no-install next export -o out

- name: Upload artifact
  uses: actions/upload-pages-artifact@v3
  with:
    path: ./out
